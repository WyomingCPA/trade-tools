import{_ as w,a as c,r as o,o as F,h as y,w as n,e as l,b as a,t as f,i as d}from"./index.06ce08cf.js";import{d as C}from"./debounce.4f3e0d5f.js";import{l as x}from"./index.baba1a11.js";const I={name:"StockFavorite",components:{},data(){const t=[],e="";return{loading:!1,items:t,columns:[{key:"name",sortable:!0},{key:"ticker",sortable:!0},{key:"figi",sortable:!0},{key:"graph15min",width:80},{key:"currency",width:80},{key:"average15day",width:80},{key:"tutci",width:80},{key:"tutci",width:80}],input:e,filter:e,isDebounceInput:!1,isCustomFilteringFn:!1,filteredCount:t.length,selectedItemsEmitted:[],listPrice:Array,serverParams:{name:""}}},methods:{filterExact(t){var e;return this.filter===""?!0:((e=t==null?void 0:t.toString)==null?void 0:e.call(t))===this.filter},updateFilter(t){this.filter=t},debouncedUpdateFilter:C(function(t){this.updateFilter(t)},600),filterPrice:function(t){this.filter=t,this.input=t},fetchRows(){let t=this;this.loading=!0,c.request({method:"get",url:"/api/stock/favorites",params:this.serverParams,paramsSerializer:e=>x.stringify(e)}).then(e=>{t.items=e.data.stocks,t.loading=!1}).catch(e=>{console.log(e),t.loading=!1})},resetInfoModal(){this.infoModal.title="",this.infoModal.content=""},unfavorite:function(t,e){var r=this;this.loading=!0,c.get("/sanctum/csrf-cookie").then(m=>{c.post("/api/stock/unfavorite",{selRows:r.selectedItemsEmitted}).then(s=>{s.status?(console.log("\u0412\u044B\u0437\u0432\u0430\u043B\u0438 \u0430\u043B\u0435\u0440\u0442"),this.$vaToast.init({message:"Success",color:"success"}),this.fetchRows(),this.loading=!1):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(s.status),this.loading=!1)})})}},computed:{customFilteringFn(){return this.isCustomFilteringFn?this.filterExact:void 0}},watch:{input(t){this.isDebounceInput?this.debouncedUpdateFilter(t):this.updateFilter(t)}},created(){this.fetchRows()}},S={class:"grid md:grid-cols-2 gap-6 mb-6"},V={class:"row"},E={class:"col"},N=d(" \u0423\u0431\u0440\u0430\u0442\u044C \u0438\u0437 \u0438\u0437\u0431\u0440\u0430\u043D\u043D\u043E\u0433\u043E "),P=["href"],R=["href"],B=d(" Number of filtered items: ");function M(t,e,r,m,s,u){const _=o("va-input"),h=o("va-button"),p=o("va-data-table"),g=o("va-chip"),v=o("va-alert"),k=o("va-card-content"),b=o("va-card");return F(),y(b,null,{default:n(()=>[l(k,null,{default:n(()=>[a("div",S,[l(_,{modelValue:s.input,"onUpdate:modelValue":e[0]||(e[0]=i=>s.input=i),placeholder:"Filter...",class:"w-full"},null,8,["modelValue"])]),a("div",V,[a("div",E,[l(h,{onClick:u.unfavorite},{default:n(()=>[N]),_:1},8,["onClick"])])]),l(p,{items:s.items,columns:s.columns,filter:s.filter,"filter-method":u.customFilteringFn,onFiltered:e[1]||(e[1]=i=>s.filteredCount=i.items.length),loading:s.loading,selectable:"","selected-color":"warning",onSelectionChange:e[2]||(e[2]=i=>s.selectedItemsEmitted=i.currentSelectedItems)},{"cell(name)":n(({rowData:i})=>[a("a",{class:"link",target:"_blank",href:"https://www.tinkoff.ru/invest/stocks/"+i.ticker},f(i.name),9,P)]),"cell(graph15min)":n(({rowData:i})=>[a("a",{target:"_blank",class:"btn btn-primary",href:"/admin/stocks/stock-chart-15min/"+i.id},"View",8,R)]),_:1},8,["items","columns","filter","filter-method","loading"]),l(v,{class:"!mt-6",color:"info",outline:""},{default:n(()=>[B,l(g,null,{default:n(()=>[d(f(s.filteredCount),1)]),_:1})]),_:1})]),_:1})]),_:1})}var q=w(I,[["render",M],["__scopeId","data-v-7667bee8"]]);export{q as default};
