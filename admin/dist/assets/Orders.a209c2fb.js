import{_ as S,a as i,r as c,o as C,h as R,w as r,e as l,b as a,i as d,t as P}from"./index.822f6c57.js";import{l as V}from"./index.4452bcda.js";const O={name:"stock-rub",data(){return{selectedItemsEmitted:[],selectedItems:[],count:{type:Number},dataUrl:{type:String},loading:!1,infoModal:{id:"info-modal",title:"",content:""},serverParams:{figi:""},items:[],columns:[{key:"id"},{key:"name-instrument"},{key:"figi"},{key:"current_price"},{key:"quantity"},{key:"spot-order-count"},{key:"stop-order-count"},{key:"created_at"},{key:"graph15min"},{key:"strategy_name"},{key:"status"},{key:"actions",width:80}]}},methods:{updateParams(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange(e){this.updateParams({page:e.currentPage}),this.fetchRows()},onSearch(e){this.updateParams({name:e}),this.fetchRows()},selectionChanged:function(e){this.selRows=e.selectedRows},successOrder:function(e,t){var s=this;this.loading=!0,i.get("/sanctum/csrf-cookie").then(h=>{i.post("/api/orders/set-success",{selRows:s.selectedItemsEmitted}).then(n=>{n.status?(console.log("\u0412\u044B\u0437\u0432\u0430\u043B\u0438 \u0430\u043B\u0435\u0440\u0442"),this.fetchRows(),this.loading=!1):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(n.status),this.loading=!1)})})},failOrder:function(e,t){var s=this;this.loading=!0,i.get("/sanctum/csrf-cookie").then(h=>{i.post("/api/orders/set-fail",{selRows:s.selectedItemsEmitted}).then(n=>{n.status?(console.log("\u0412\u044B\u0437\u0432\u0430\u043B\u0438 \u0430\u043B\u0435\u0440\u0442"),this.fetchRows(),this.loading=!1):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(n.status),this.loading=!1)})})},nothingOrder:function(e,t){var s=this;this.loading=!0,i.get("/sanctum/csrf-cookie").then(h=>{i.post("/api/orders/set-nothing",{selRows:s.selectedItemsEmitted}).then(n=>{n.status?(console.log("\u0412\u044B\u0437\u0432\u0430\u043B\u0438 \u0430\u043B\u0435\u0440\u0442"),this.fetchRows(),this.loading=!1):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(n.status),this.loading=!1)})})},deleteOrder:function(e){this.loading=!0,i.get("/sanctum/csrf-cookie").then(t=>{i.post("/api/orders/delete",{selRows:e}).then(s=>{s.status?(console.log("\u0412\u044B\u0437\u0432\u0430\u043B\u0438 \u0430\u043B\u0435\u0440\u0442"),this.fetchRows(),this.loading=!1):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(s.status),this.loading=!1)})})},getNote(e,t,s){this.infoModal.title=e.created_at,this.infoModal.content=e.note,this.idCheck=e.id,console.log(e.note),this.$root.$emit("bv::show::modal",this.infoModal.id,s)},handleOk(e){e.preventDefault(),this.handleSubmit()},handleSubmit(){},fetchRows(){let e=this;this.loading=!0,i.request({method:"post",url:"/api/orders/index",params:this.serverParams,paramsSerializer:t=>V.stringify(t)}).then(t=>{e.items=t.data.orders,e.count=t.data.count,this.loading=!1}).catch(t=>{console.log(t),this.loading=!1})},onPerPageChange(e){this.updateParams({perPage:e.currentPerPage}),this.fetchRows()},async startScriptSuperTrend15min(){let e=this;this.loading=!0,i.get("/sanctum/csrf-cookie").then(t=>{i.post("/api/orders/start-script-super-trend-15min",{}).then(s=>{s.status?(e.loading=!1,this.fetchRows()):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(s.status),e.loading=!1)}).catch(function(s){console.log(t),console.error(s)})})},async stopScriptSuperTrend15min(){let e=this;this.loading=!0,i.get("/sanctum/csrf-cookie").then(t=>{i.post("/api/orders/stop-script-super-trend-15min",{}).then(s=>{s.status?(e.loading=!1,this.fetchRows()):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(s.status),e.loading=!1)}).catch(function(s){console.log(t),console.error(s)})})},async startScriptCheckStopOrder(){let e=this;this.loading=!0,i.get("/sanctum/csrf-cookie").then(t=>{i.post("/api/orders/start-script-check-stop-order",{}).then(s=>{s.status?(this.loading=!1,this.fetchRows()):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(s.status),e.loading=!1)}).catch(function(s){console.log(t),console.error(s)})})},getStatusBadgeClass(e){return console.log(e),e=="empty"?"primary":e=="success"?"success":e=="fail"?"danger":e=="nothing"?"secondary":""}},created(){this.fetchRows()},requestAdapter(e){return{sort:e.orderBy?e.orderBy:"name",direction:e.ascending?"asc":"desc",limit:e.limit?e.limit:5,page:e.page,name:e.query.name,created_by:e.query.created_by,type:e.query.type,created_at:e.query.created_at}}},x={class:"grid md:grid-cols-2 gap-6 mb-6"},B={class:"grid md:grid-cols-2 gap-6 mb-6"},I={class:"grid md:grid-cols-2 gap-6 mb-6"},q={class:"grid md:grid-cols-2 gap-6 mb-6"},T={class:"flex flex-wrap gap-6 mb-6"},N=d("Start Script 15 min"),A=d("Stop Script 15 min"),E={class:"flex flex-wrap gap-6 mb-6"},F=d("\u041D\u0435\u0443\u0434\u0430\u0447\u043D\u0430\u044F \u0441\u0434\u0435\u043B\u043A\u0430"),M=d("\u041D\u0438\u0447\u0435\u0433\u043E"),U=d("\u0423\u0441\u043F\u0435\u0448\u043D\u0430\u044F \u0441\u0434\u0435\u043B\u043A\u0430"),j={class:"grid md:grid-cols-2 gap-6 mb-6"},D={class:"flex flex-wrap gap-6 mt-6"},z=["href"],G=d("\u0423\u0434\u0430\u043B\u0438\u0442\u044C"),H={colspan:"6"},J={class:"flex justify-center mt-4"},K=d(" Number of filtered items: ");function L(e,t,s,h,n,u){const m=c("VaAlert"),g=c("va-button"),p=c("va-input"),f=c("VaBadge"),_=c("va-pagination"),v=c("va-data-table"),w=c("va-chip"),y=c("va-alert"),k=c("va-card-content"),b=c("va-card");return C(),R(b,null,{default:r(()=>[l(k,null,{default:r(()=>[a("div",x,[l(m,{description:"\u0417\u0430\u043F\u0443\u0441\u043A \u0431\u043E\u0442\u0430 15 \u043C\u0438\u043D<code>nohup /var/www/trader/env/bin/python /var/www/trader/SuperTrend_MACD_TimeFrame_15min.py &</code>"})]),a("div",B,[l(m,{description:"\u0417\u0430\u043F\u0443\u0441\u043A \u0447\u0435\u043A\u0435\u0440\u0430 \u0441\u0442\u043E\u043F-\u043E\u0440\u0434\u0435\u0440\u043E\u0432<code> nohup /var/www/trader/env/bin/python /var/www/trader/check_stop_order.py &</code>"})]),a("div",I,[l(m,{description:"\u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430 \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u044F \u043F\u0440\u043E\u0446\u0435\u0441\u0441\u0430 <code>ps -ef | grep python</code>"})]),a("div",q,[a("div",T,[l(g,{color:"success",onClick:t[0]||(t[0]=o=>u.startScriptSuperTrend15min())},{default:r(()=>[N]),_:1}),l(g,{color:"danger",onClick:t[1]||(t[1]=o=>u.stopScriptSuperTrend15min())},{default:r(()=>[A]),_:1})]),a("div",E,[l(g,{color:"danger",onClick:u.failOrder},{default:r(()=>[F]),_:1},8,["onClick"]),l(g,{color:"info",onClick:u.nothingOrder},{default:r(()=>[M]),_:1},8,["onClick"]),l(g,{color:"success",onClick:u.successOrder},{default:r(()=>[U]),_:1},8,["onClick"])]),a("div",j,[a("div",D,[l(p,{modelValue:e.input,"onUpdate:modelValue":t[2]||(t[2]=o=>e.input=o),placeholder:"Filter...",class:"w-full"},null,8,["modelValue"])])])]),l(v,{modelValue:n.selectedItems,"onUpdate:modelValue":t[4]||(t[4]=o=>n.selectedItems=o),loading:n.loading,selectable:"","selected-color":"warning",items:n.items,columns:n.columns,filter:e.filter,"filter-method":e.customFilteringFn,onFiltered:t[5]||(t[5]=o=>e.filteredCount=o.items.length),onSelectionChange:t[6]||(t[6]=o=>n.selectedItemsEmitted=o.currentSelectedItems)},{"cell(graph15min)":r(({rowData:o})=>[a("a",{target:"_blank",class:"btn btn-primary",href:"/admin/algo-trading/order-chart-15min/"+o.id},"View",8,z)]),"cell(status)":r(({rowData:o})=>[l(f,{text:o.status,color:u.getStatusBadgeClass(o.status),class:"mr-2"},null,8,["text","color"])]),"cell(actions)":r(({rowData:o})=>[l(g,{color:"danger",onClick:Q=>u.deleteOrder(o.id)},{default:r(()=>[G]),_:2},1032,["onClick"])]),bodyAppend:r(()=>[a("tr",null,[a("td",H,[a("div",J,[l(_,{modelValue:e.currentPage,"onUpdate:modelValue":t[3]||(t[3]=o=>e.currentPage=o),pages:e.pages},null,8,["modelValue","pages"])])])])]),_:1},8,["modelValue","loading","items","columns","filter","filter-method"]),l(y,{class:"!mt-6",color:"info",outline:""},{default:r(()=>[K,l(w,null,{default:r(()=>[d(P(n.count),1)]),_:1})]),_:1})]),_:1})]),_:1})}var Y=S(O,[["render",L]]);export{Y as default};
